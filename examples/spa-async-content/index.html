<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SPA Async Content (Missing Labels)</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <main class="page">
      <header class="header">
        <p class="eyebrow">ARIA anti-pattern demo</p>
        <h1>SPA Async Content</h1>
        <p class="subtitle">
          This page simulates an async fetch that replaces the content after a delay.
          The injected cards include icon-only controls and images missing alt text.
        </p>
      </header>

      <section class="shell">
        <div class="actions">
          <button class="reload" type="button" id="reload">Refresh async feed</button>
          <span class="status" id="status">Waiting for content...</span>
        </div>
        <div id="panel"></div>
      </section>
    </main>

    <script>
      const panel = document.getElementById('panel');
      const status = document.getElementById('status');
      const reload = document.getElementById('reload');

      const previewOne = "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='96' height='70'><rect width='96' height='70' fill='%23fef9c3'/><rect x='10' y='12' width='28' height='46' rx='6' fill='%23fde047'/><rect x='46' y='18' width='40' height='34' rx='6' fill='%23facc15'/></svg>";
      const previewTwo = "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='96' height='70'><rect width='96' height='70' fill='%23ecfeff'/><circle cx='30' cy='35' r='16' fill='%2367e8f9'/><rect x='52' y='16' width='32' height='38' rx='8' fill='%2306b6d4'/></svg>";
      const previewThree = "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='96' height='70'><rect width='96' height='70' fill='%23f5f3ff'/><rect x='12' y='10' width='20' height='50' rx='4' fill='%23c4b5fd'/><rect x='38' y='20' width='20' height='40' rx='4' fill='%23938cf5'/><rect x='64' y='30' width='20' height='30' rx='4' fill='%238b5cf6'/></svg>";

      const cards = [
        {
          title: 'Inbox triage',
          note: 'New updates arriving from the support pipeline.',
          image: previewOne
        },
        {
          title: 'Client reminders',
          note: 'Async payload includes unlabeled notification actions.',
          image: previewTwo
        },
        {
          title: 'Retention watch',
          note: 'Delayed content injects missing-alt thumbnails.',
          image: previewThree
        }
      ];

      const renderLoading = () => {
        status.textContent = 'Fetching new cards...';
        panel.innerHTML = `
          <div class="placeholder">
            <div class="skeleton"></div>
            <div class="skeleton"></div>
            <div class="skeleton" style="width: 60%"></div>
          </div>
        `;
      };

      const renderCards = () => {
        status.textContent = 'Async content loaded.';
        panel.innerHTML = `
          <div class="grid">
            ${cards
              .map(
                (card) => `
                  <article class="card">
                    <div class="media">
                      <img src="${card.image}">
                      <div>
                        <h2>${card.title}</h2>
                        <p class="small">${card.note}</p>
                      </div>
                    </div>
                    <div class="toolbar">
                      <button class="icon-button" type="button">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                          <path d="M4 12h16"></path>
                          <path d="M12 4v16"></path>
                        </svg>
                      </button>
                      <button class="icon-button" type="button">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                          <path d="M6 8h12"></path>
                          <path d="M6 12h12"></path>
                          <path d="M6 16h12"></path>
                        </svg>
                      </button>
                      <button class="icon-button" type="button">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                          <circle cx="12" cy="12" r="7"></circle>
                          <path d="M12 9v6"></path>
                          <path d="M9 12h6"></path>
                        </svg>
                      </button>
                    </div>
                  </article>
                `
              )
              .join('')}
          </div>
        `;
      };

      let timer = null;
      const simulateFetch = () => {
        renderLoading();
        if (timer) {
          clearTimeout(timer);
        }
        timer = setTimeout(() => {
          renderCards();
        }, 1400);
      };

      reload.addEventListener('click', simulateFetch);
      simulateFetch();
    </script>
  </body>
</html>
